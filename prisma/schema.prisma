// Prisma 스키마 파일
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// 사이트 정보 모델
model Site {
  id             String    @id @default(cuid())
  name           String    @unique // 영문 식별자 (예: "clien", "fmkorea")
  displayName    String // 표시 이름 (예: "클리앙", "에펨코리아")
  url            String // 사이트 메인 URL
  logo           String? // 로고 이미지 URL
  crawlInterval  Int       @default(360) // 크롤링 주기 (분)
  isActive       Boolean   @default(true) // 활성화 상태
  lastCrawledAt  DateTime? // 마지막 크롤링 시간
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  posts          Post[] // 사이트에 속한 게시글들

  @@index([name])
  @@index([isActive])
}

// 게시글 모델
model Post {
  id           String    @id @default(cuid())
  title        String // 게시글 제목
  author       String // 작성자
  siteId       String // 사이트 ID
  site         Site      @relation(fields: [siteId], references: [id], onDelete: Cascade)
  url          String    @unique // 원본 게시글 URL
  thumbnail    String? // 썸네일 이미지 URL
  viewCount    Int?      @default(0) // 조회수
  commentCount Int?      @default(0) // 댓글수
  likeCount    Int?      @default(0) // 좋아요수
  category     String? // 카테고리
  createdAt    DateTime // 게시글 원본 작성 시간
  fetchedAt    DateTime  @default(now()) // 크롤링된 시간
  updatedAt    DateTime  @updatedAt

  @@index([siteId])
  @@index([createdAt])
  @@index([fetchedAt])
  @@index([url])
}
